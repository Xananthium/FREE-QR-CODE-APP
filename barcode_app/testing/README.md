# QR Code Scannability Testing Guide

## Purpose

This directory contains testing documentation and procedures to ensure all QR codes generated by the barcode app scan reliably on real devices with all combinations of:
- QR types (URL, WiFi)
- Border styles (10+ decorative borders)
- Export resolutions (512px - 4096px)
- Export formats (PNG, JPEG)

## Quick Start

### Prerequisites
- iOS device with camera (iPhone/iPad)
- Android device with camera
- Multiple QR scanner apps installed
- Access to WiFi networks for testing
- Image viewer to check exported QR codes

### 5-Minute Smoke Test

1. **Build and run the app** on a test device
2. **Generate URL QR**: Enter `https://example.com`
3. **Apply Classic border** (or no border for baseline)
4. **Export as 1024×1024 PNG**
5. **Scan with native camera app**
6. **Expected**: Scans within 2 seconds, opens correct URL

If this fails, there's a critical issue. If it passes, proceed with full testing.

## Full Testing Procedure

### Step 1: Setup Test Environment

Install QR scanner apps:
- **iOS**: Native Camera app, Google Lens
- **Android**: Native Camera app, Google Lens, QR Code Reader
- Document which apps you're testing with

### Step 2: Generate Test QR Codes

Create QR codes for each test case in `qr_scannability_checklist.md`:
- **URLs**: Simple, complex, with paths, with query params
- **WiFi**: WPA, WEP, open networks

### Step 3: Export at All Resolutions

For each QR code, export at:
- 512×512px (Small)
- 1024×1024px (Medium)
- 2048×2048px (Large)
- 4096×4096px (Extra Large)

### Step 4: Test Each Border Style

Apply all available borders:
- No border (baseline)
- Classic
- Minimal
- Rounded
- Dotted
- Geometric
- Gradient
- Floral
- Ornate
- Shadow

### Step 5: Scan and Document

For each combination:
1. Open exported image on test device or second screen
2. Launch scanner app
3. Point camera at QR code
4. Time how long it takes to scan
5. Verify correct data is extracted
6. Record result in checklist

### Step 6: Test Edge Cases

- Low light conditions
- Bright sunlight/glare
- Angled scanning (30-45 degrees)
- Different scanning distances (close, medium, far)
- JPEG vs PNG comparison

## Test Data

### URLs for Testing

```
# Simple domain
https://example.com

# URL with path
https://example.com/path/to/page

# URL with query parameters
https://example.com/search?q=test&lang=en&page=1

# URL with special characters
https://example.com/path%20with%20spaces?param=value&other=test

# Long URL (stress test)
https://example.com/very/long/path/that/includes/many/segments/to/increase/qr/code/density/and/test/scannability/at/higher/data/volumes
```

### WiFi Networks for Testing

```yaml
# WPA Network
Type: WPA/WPA2
SSID: TestNetwork
Password: Test123!@#
Hidden: false

# Open Network
Type: Open (nopass)
SSID: OpenTestNetwork
Password: (none)
Hidden: false

# WEP Network (if available)
Type: WEP
SSID: WEPNetwork
Password: 1234567890
Hidden: false

# Hidden WPA Network
Type: WPA/WPA2
SSID: HiddenNetwork
Password: SecurePass123
Hidden: true

# Special Characters
Type: WPA/WPA2
SSID: Test Network 2024
Password: P@ssw0rd!#$%
Hidden: false
```

## Pass/Fail Criteria

### PASS Criteria

A QR code **PASSES** if it meets ALL of the following:
- Scans successfully within 2 seconds
- Extracts correct data (URL opens correctly, WiFi connects)
- Works with native camera app (not just specialty apps)
- Scans at standard distance (30-50cm from screen/paper)
- Works in normal indoor lighting conditions
- No visible artifacts or quality issues

### FAIL Criteria

A QR code **FAILS** if ANY of the following occur:
- Takes longer than 5 seconds to scan
- Fails to scan after 10 seconds
- Extracts incorrect data
- Only works with specific scanner apps
- Requires very close range (< 10cm)
- Only works in perfect lighting/angle conditions
- Shows visible compression artifacts (JPEG)
- Border encroaches on quiet zone

### MARGINAL Cases

Document as "Marginal" if:
- Takes 2-5 seconds to scan consistently
- Works but requires optimal conditions
- Scans on some devices but not others

These should be investigated and potentially improved.

## Common Issues and Solutions

### Issue: QR Won't Scan
**Possible Causes**:
- Insufficient quiet zone (border too close)
- Resolution too low for data density
- JPEG compression artifacts
- Insufficient contrast

**Solutions**:
- Increase quiet zone padding
- Use higher resolution
- Use PNG instead of JPEG
- Use black/white for maximum contrast

### Issue: WiFi QR Won't Connect
**Possible Causes**:
- Incorrect WiFi format string
- Special characters not properly escaped
- Wrong security type specified
- Network not in range

**Solutions**:
- Verify format: `WIFI:T:WPA;S:SSID;P:password;;`
- Check escape sequences for `;`, `:`, `,`, `\`, `"`
- Ensure correct security type (WPA/WEP/nopass)
- Be in range of the network

### Issue: Slow Scanning (3-5 seconds)
**Possible Causes**:
- Marginal quiet zone
- Suboptimal error correction level
- Poor lighting conditions

**Solutions**:
- Increase quiet zone to 15% (recommended)
- Use High error correction for exports
- Test in better lighting

## Automated Validation

### Quiet Zone Validation

Use the `QRValidator` utility to programmatically check quiet zone:

```dart
import 'package:barcode_app/core/utils/qr_validator.dart';

void validateExportSettings() {
  // Validate each export resolution
  final resolutions = [512, 1024, 2048, 4096];
  
  for (final size in resolutions) {
    final padding = size * 0.10; // Current: 10%
    final validation = QRValidator.validateQuietZone(
      qrSize: size.toDouble(),
      padding: padding,
    );
    
    print('$size px: ${validation.status} - ${validation.recommendation}');
  }
}
```

Expected output:
```
512 px: adequate - Adequate quiet zone - meets ISO/IEC 18004 minimum
1024 px: adequate - Adequate quiet zone - meets ISO/IEC 18004 minimum
2048 px: adequate - Adequate quiet zone - meets ISO/IEC 18004 minimum
4096 px: adequate - Adequate quiet zone - meets ISO/IEC 18004 minimum
```

## Reporting Results

### Document All Results

Use `qr_scannability_checklist.md` to track every test. Fill in:
- Test case name
- Configuration (resolution, border, format)
- Pass/Fail result
- Time to scan
- Any notes or issues

### Critical Issues

If you find a **critical issue** (QR code doesn't scan at all):
1. Document the exact configuration
2. Take screenshots of the QR code
3. Test on multiple devices/apps
4. Report immediately - this blocks the task

### Minor Issues

If you find a **minor issue** (slow scanning, works but not ideal):
1. Document the issue
2. Note which configurations are affected
3. Test workarounds
4. Include in final report with recommendations

## Success Criteria

This task is complete when:
- ✅ All critical tests pass (URL + WiFi basics)
- ✅ At least 95% of all test combinations pass
- ✅ All border types maintain scannability
- ✅ All resolutions produce scannable codes
- ✅ WiFi QR codes successfully connect to networks
- ✅ No critical issues remain unresolved
- ✅ Documentation is complete and accurate

## Files in This Directory

- `README.md` - This file, testing guide and procedures
- `qr_scannability_checklist.md` - Detailed test checklist with all test cases
- (Future) `test_results_YYYY-MM-DD.md` - Test run results

## Tools and Utilities

### QRValidator (`lib/core/utils/qr_validator.dart`)

Validates quiet zone compliance:
- `validateQuietZone()` - Check if padding is adequate
- `calculateRecommendedPadding()` - Get optimal padding for a QR size
- `calculateMinimumPadding()` - Get minimum acceptable padding

### Export Factory (`lib/widgets/qr_display.dart`)

The `QrDisplay.export()` factory creates high-quality QR codes with:
- 10% quiet zone (ISO/IEC 18004 minimum)
- High error correction (30% recovery)
- Explicit black/white colors
- No container decoration

### Border System (`lib/borders/`)

All decorative borders extend `DecorativeBorder` and include:
- `padding` property - space between QR and border
- `build()` method - wraps QR with border
- Borders should never encroach on QR quiet zone

## Questions?

If anything is unclear:
1. Check the main checklist (`qr_scannability_checklist.md`)
2. Review QR validator utility code
3. Refer to QR display widget documentation
4. Consult ISO/IEC 18004 standard (QR code specification)

## Next Steps

After completing testing:
1. ✅ Fill out complete checklist
2. ✅ Document any issues found
3. ✅ Create test results report
4. ✅ Update this guide with lessons learned
5. ✅ Mark FLUTTER 10.8 task as complete
